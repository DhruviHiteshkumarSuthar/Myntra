<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Preferences</title>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
<style>
  .container {
    margin-top: 50px;
  }
  .section-heading {
    font-size: 24px;
    margin-bottom: 20px;
  }
  .item-container {
    display: flex;
    flex-wrap: wrap;
    justify-content: space-between;
  }
  .item {
    width: 150px;
    text-align: center;
    margin-bottom: 20px;
  }
  .item img {
    width: 100%;
    border-radius: 8px;
    cursor: pointer;
  }
  .item.selected img {
    border: 3px solid rgb(242,85,17);
  }
  .submit-btn {
    background-color: rgb(242,85,17);
    color: #fff;
    font-size: 15px;
    padding: 10px 45px;
    border: none;
    border-radius: 8px;
    font-weight: 600;
    letter-spacing: 0.5px;
    text-transform: uppercase;
    cursor: pointer;
    transition: all 0.2s ease-in-out;
    margin-top: 20px;
  }
  .submit-btn:hover {
    background-color: #fff;
    color: rgb(242,85,17);
    border: 3px solid rgb(242,85,17);
  }
</style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1 id="greeting"></h1>
    </div>
    <div class="section">
      <div class="section-heading">Select Your Favorite Brands</div>
      <div class="item-container" id="brands">
        <!-- Brands items will be dynamically added here -->
      </div>
    </div>
    <div class="section">
      <div class="section-heading">Select Your Favorite Categories</div>
      <div class="item-container" id="categories">
        <!-- Categories items will be dynamically added here -->
      </div>
    </div>
    <div class="section">
      <div class="section-heading">Select Your Favorite Patterns</div>
      <div class="item-container" id="patterns">
        <!-- Patterns items will be dynamically added here -->
      </div>
    </div>
    <div class="section">
      <div class="section-heading">Rank the Parameters</div>
      <div class="item-container">
        <label for="brand-rank">Brand:</label>
        <input type="number" id="brand-rank" name="brand-rank" min="1" max="4">
        <label for="price-rank">Price:</label>
        <input type="number" id="price-rank" name="price-rank" min="1" max="4">
        <label for="pattern-rank">Print & Pattern:</label>
        <input type="number" id="pattern-rank" name="pattern-rank" min="1" max="4">
        <label for="category-rank">Category:</label>
        <input type="number" id="category-rank" name="category-rank" min="1" max="4">
      </div>
    </div>
    <button class="submit-btn" id="submit-btn">Submit</button>
  </div>
  <script>
    document.addEventListener("DOMContentLoaded", function() {
      const urlParams = new URLSearchParams(window.location.search);
      const name = urlParams.get('name');
      document.getElementById('greeting').textContent = `Hello! ${name}`;

      const brands = [
        { name: 'SASSAFRAS', image: 'SASSAFRAS.png' },
        { name: 'Sera', image: 'Sera.png' },
        { name: 'Tokyo Talkies', image: 'Tokyo_Talkies.png' },
        { name: 'Athena', image: 'Athena.png' },
        { name: 'Berrylush', image: 'Berrylush.png' },
        { name: 'STREET 9', image: 'STREET_9.png' },
        { name: 'StyleCast', image: 'StyleCast.png' },
        { name: 'Bewakoof', image: 'Bewakoof.png' },
        { name: 'CURVY STREET', image: 'CURVY_STREET.png' },
        { name: 'Roadster', image: 'Roadster.png' },
        { name: 'DressBerry', image: 'DressBerry.png' }
        // Add more brands here
      ];
      const categories = [
        { name: 'Ethnic', image: 'ethnic.png' },
        { name: 'Western', image: 'Western.png' },
        { name: 'Plus Size', image: 'Plus_Size.png' },
        { name: 'Formal', image: 'Formal.png' },
        { name: 'Active Wear', image: 'Active_Wear.png' }
        // Add more categories here
      ];
      const patterns = [
        { name: 'Solid', image: 'Solid.png' },
        { name: 'Geometric', image: 'Geometric.png' },
        { name: 'Ethnic Motifs', image: 'Ethnic_Motifs.png' },
        { name: 'Floral', image: 'Floral.png' },
        { name: 'Typography', image: 'Typography.png' },
        { name: 'Checked', image: 'Checked.png' },
        { name: 'Tie and Dye', image: 'Tie_and_Dye.png' },
        { name: 'Bandhani', image: 'Bandhani.png' },
        { name: 'Faded', image: 'Faded.png' },
        { name: 'Striped', image: 'striped.png' }
        // Add more patterns here
      ];

      // const brandContainer = document.getElementById('brands');
      // const categoryContainer = document.getElementById('categories');
      // const patternContainer = document.getElementById('patterns');

      function createItemContainer(items, containerId) {
        const container = document.getElementById(containerId);
        items.forEach(item => {
          const itemElement = document.createElement('div');
          itemElement.classList.add('item');
          itemElement.innerHTML = `
            <img src="${item.image}" alt="${item.name}">
            <div>${item.name}</div>
          `;
          itemElement.addEventListener('click', () => {
            itemElement.classList.toggle('selected');
          });
          container.appendChild(itemElement);
        });
      }

      createItemContainer(brands, 'brands');
      createItemContainer(categories, 'categories');
      createItemContainer(patterns, 'patterns');

      document.getElementById('submit-btn').addEventListener('click', () => {
        const selectedBrands = [...document.querySelectorAll('#brands .item.selected')].map(item => item.innerText.trim());
        const selectedCategories = [...document.querySelectorAll('#categories .item.selected')].map(item => item.innerText.trim());
        const selectedPatterns = [...document.querySelectorAll('#patterns .item.selected')].map(item => item.innerText.trim());

        if (selectedBrands.length < 2 || selectedCategories.length < 2 || selectedPatterns.length < 2) {
          alert('Please select at least 2 items from each category.');
          return;
        }

        const brandRank = document.getElementById('brand-rank').value;
        const priceRank = document.getElementById('price-rank').value;
        const patternRank = document.getElementById('pattern-rank').value;
        const categoryRank = document.getElementById('category-rank').value;

        const preferences = {
          name: name,
          brands: selectedBrands,
          categories: selectedCategories,
          patterns: selectedPatterns,
          ranks: {
            brand: brandRank,
            price: priceRank,
            pattern: patternRank,
            category: categoryRank
          }
        };

        fetch('/save-preferences', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify(preferences)
        })
        .then(response => {
          if (response.ok) {
            alert('Preferences saved successfully');
            window.location.href = `/recommendations.html?name=${name}`;
          } else {
            alert('Error saving preferences');
          }
        })
        .catch(error => {
          console.error('Error:', error);
        });
      });
    });
  </script>
</body>
</html>
